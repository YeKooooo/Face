# 智能用药提醒机器人表情输出扩展文档

## 概述

本文档定义了智能用药提醒机器人在语音识别和用户交互过程中的表情输出扩展字段，基于现有的表情系统为用户交互提供更丰富的情感反馈。

## 扩展JSON结构

在原有的语音识别响应结构基础上，新增 `emotion_output` 字段：

```json
{
  "transcription": "你知道我是谁吗？",
  "speaker": {
    "id": "USR1755675801",
    "code": "USR1755675801",
    "name": "张三",
    "status": "registered",
    "confidence": 0.75
  },
  "mentioned_persons": [
    {
      "id": "USR1755675801",
      "name": "张三",
      "relation_type": "self",
      "status": "registered"
    }
  ],
  "uncertainty_flags": [],
  "emotion_output": {
    "expression_type": "caring",
    "duration_ms": 3000,
    "trigger_reason": "user_identity_inquiry"
  }
}
```

## emotion_output 字段详细说明

### 基础属性

| 字段名 | 类型 | 描述 | 可选值 |
|--------|------|------|--------|
| `expression_type` | string | 表情类型 | `happy`, `caring`, `concerned`, `encouraging`, `alert`, `sad`, `neutral` |
| `duration_ms` | integer | 表情持续时间 (毫秒) | 1000-10000，-1表示永久切换 |
| `trigger_reason` | string | 触发表情的原因 | 自定义字符串 |

## 表情类型映射表

基于智能用药提醒机器人表情系统文档中定义的7种基础情感表情：

### 1. Happy (开心)
- **应用场景**：成功完成用药、健康状况良好、积极反馈
- **基础配置**：
  ```json
  {
    "expression_type": "happy",
    "duration_ms": 2500,
    "trigger_reason": "medication_completed"
  }
  ```

### 2. Caring (关怀)
- **应用场景**：用药提醒、健康关怀、温暖陪伴
- **基础配置**：
  ```json
  {
    "expression_type": "caring",
    "duration_ms": 3000,
    "trigger_reason": "medication_reminder"
  }
  ```

### 3. Concerned (担忧)
- **应用场景**：用户延迟用药、健康指标异常、需要关注的情况
- **基础配置**：
  ```json
  {
    "expression_type": "concerned",
    "duration_ms": 4000,
    "trigger_reason": "medication_delayed"
  }
  ```

### 4. Encouraging (鼓励)
- **应用场景**：激励用户坚持治疗、克服困难、积极面对
- **基础配置**：
  ```json
  {
    "expression_type": "encouraging",
    "duration_ms": 3500,
    "trigger_reason": "treatment_motivation"
  }
  ```

### 5. Alert (警觉)
- **应用场景**：紧急情况、重要提醒、需要立即关注
- **基础配置**：
  ```json
  {
    "expression_type": "alert",
    "duration_ms": 5000,
    "trigger_reason": "health_emergency"
  }
  ```

### 6. Sad (难过)
- **应用场景**：用户身体不适、治疗效果不佳、表示同情
- **基础配置**：
  ```json
  {
    "expression_type": "sad",
    "duration_ms": 4500,
    "trigger_reason": "user_discomfort"
  }
  ```

### 7. Neutral (中性)
- **应用场景**：默认状态、日常交互、过渡状态
- **基础配置**：
  ```json
  {
    "expression_type": "neutral",
    "duration_ms": -1,
    "trigger_reason": "default_state"
  }
  ```

## 使用示例

### 场景1：用户询问身份识别
**基础配置示例**：
```json
{
  "transcription": "你知道我是谁吗？",
  "speaker": {
    "id": "USR1755675801",
    "name": "张三",
    "status": "registered",
    "confidence": 0.75
  },
  "emotion_output": {
    "expression_type": "caring",
    "duration_ms": 3000,
    "trigger_reason": "user_identity_inquiry"
  }
}
```

### 场景2：用药提醒
**基础配置示例**：
```json
{
  "transcription": "该吃药了",
  "emotion_output": {
    "expression_type": "encouraging",
    "duration_ms": 4000,
    "trigger_reason": "medication_reminder"
  }
}
```

### 场景3：紧急情况
**基础配置示例**：
```json
{
  "transcription": "血压异常！",
  "emotion_output": {
    "expression_type": "alert",
    "duration_ms": 6000,
    "trigger_reason": "health_emergency"
  }
}
```

## 字段使用指南

### 字段优先级

1. **expression_type**：最高优先级，决定基础表情类型
2. **duration_ms**：控制表情持续时间，-1表示永久状态
3. **trigger_reason**：用于日志记录和调试分析
