# 智能用药提醒机器人表情插值生成器

## 功能描述

这个Python程序用于生成所有表情相互切换的中间插值表情，并将结果有序存放在对应文件夹下。支持7种基础表情之间的平滑过渡动画生成。

## 支持的表情类型

1. **Happy** (开心) 😊 - 浅绿背景，深绿文字
2. **Caring** (关怀) 🤗 - 粉色背景，棕色文字  
3. **Concerned** (担忧) 😟 - 橙色背景，棕色文字
4. **Encouraging** (鼓励) 💪 - 浅蓝背景，深蓝文字
5. **Alert** (警示) ⚠️ - 橙红背景，深红文字
6. **Sad** (悲伤) 😢 - 灰色背景，深灰文字
7. **Neutral** (中性) 😐 - 浅灰背景，深灰文字

## 安装依赖

```bash
# 安装Python依赖包
pip install -r requirements.txt
```

## 使用方法

### 1. 运行生成器

```bash
python expression_interpolation_generator.py
```

### 2. 交互式操作

程序启动后会显示：
- 支持的表情列表
- 将要生成的插值序列数量
- 确认提示

输入 `y` 或 `yes` 开始生成，其他任何输入将取消操作。

### 3. 生成过程

程序会自动：
- 创建 `expression_interpolations` 输出目录
- 为每对表情生成一个子文件夹
- 在每个子文件夹中生成11帧插值图像（包含起始和结束帧）
- 保存元数据和统计信息

## 输出结构

```
expression_interpolations/
├── generation_report.json          # 整体生成统计
├── Happy_to_Caring/
│   ├── frame_000_t0.00.png        # 起始帧（Happy）
│   ├── frame_001_t0.10.png        # 插值帧 10%
│   ├── frame_002_t0.20.png        # 插值帧 20%
│   ├── ...
│   ├── frame_010_t1.00.png        # 结束帧（Caring）
│   └── metadata.json              # 该序列的详细参数
├── Happy_to_Concerned/
│   └── ...
└── ... (共42个插值序列文件夹)
```

## 技术特性

### 插值算法
- **平滑插值**: 使用 ease-in-out 曲线实现自然过渡
- **颜色插值**: RGB颜色空间线性插值
- **参数插值**: 缩放、透明度等数值参数平滑过渡
- **符号切换**: 表情符号在50%处切换

### 图像生成
- **分辨率**: 200x200 像素 PNG 格式
- **透明度**: 支持 RGBA 通道
- **字体**: 自动检测系统字体，回退到默认字体
- **边框**: 自动生成匹配的边框颜色

### 数据管理
- **元数据**: 每个序列包含完整的参数记录
- **统计报告**: 生成总体统计和配置信息
- **文件命名**: 规范化命名便于排序和识别

## 生成统计

- **表情数量**: 7种基础表情
- **插值序列**: 42个（7×6，不包含自身到自身）
- **每序列帧数**: 11帧（包含起始和结束）
- **总帧数**: 462帧
- **插值步数**: 10步（0.0 到 1.0，步长0.1）

## 使用场景

1. **动画制作**: 为Qt应用程序提供平滑的表情切换动画
2. **UI设计**: 预览不同表情之间的过渡效果
3. **测试验证**: 验证表情插值算法的视觉效果
4. **资源生成**: 批量生成表情动画资源

## 注意事项

1. **存储空间**: 生成的图像文件较多，确保有足够的磁盘空间
2. **字体支持**: 表情符号显示效果取决于系统字体支持
3. **中断恢复**: 可以随时按 Ctrl+C 中断生成过程
4. **重复运行**: 重复运行会覆盖已有文件

## 错误处理

程序包含完善的错误处理机制：
- 字体加载失败时自动回退
- 目录创建权限检查
- 用户中断优雅处理
- 详细的错误信息和堆栈跟踪

## 扩展说明

如需修改生成参数，可以编辑 `ExpressionInterpolator` 类中的配置：
- `interpolation_steps`: 插值步数（默认10）
- `image_size`: 图像尺寸（默认200x200）
- `expressions`: 表情参数定义

---

**开发者**: QT_ROS_Dev  
**版本**: 1.0  
**兼容性**: Python 3.6+, Windows/Linux/macOS